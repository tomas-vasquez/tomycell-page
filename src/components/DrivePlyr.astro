---
const { id } = Astro.props;
const apiKey = "AIzaSyD739-eb6NzS_KbVJq1K8ZAxnrMfkIqPyw";
---

<head>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vlitejs@4/dist/vlite.css" />
</head>

<video id="player" class="vlite-js" controls data-id={id} data-apikey={apiKey}></video>

<script src="https://cdn.jsdelivr.net/npm/vlitejs@4"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const videoElement = document.getElementById("player");
    const videoID = videoElement.dataset.id;
    const apiKey = videoElement.dataset.apikey;

    try {
      const { id: driveID } = JSON.parse(atob(videoID));
      videoElement.src = `https://www.googleapis.com/drive/v3/files/${driveID}?alt=media&key=${apiKey}`;
      videoElement.poster = `https://lh3.googleusercontent.com/d/${driveID}`;
      
      new Vlitejs(videoElement);
    } catch (error) {
      console.error("Error al procesar el ID del video:", error);
    }
  });
</script>